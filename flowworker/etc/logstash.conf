input {
    pipe {
        codec => "json"
        command => "tshark -i enp0s9 -a duration:60 -q -lT pdml ether src b4:be:b1:6b:00:b5 | \
        /vagrant/flowworker.py -i enp0s9"
    }
    #stdin {}
}

filter{
    ruby {
        code => "event['env.hostname'] = data = File.read('/etc/hostname').strip()"
    }
    geoip {
        source => "ip.src"
        target => "ip.src.geoip" 
    }
    geoip {
        source => "ip.dst"
        target => "ip.dst.geoip" 
    }
}

output {
    elasticsearch {
        cluster => "EtherFlows"
        protocol => "transport"
        template_overwrite => true
        template => "/vagrant/etc/template.js"
    }
}

