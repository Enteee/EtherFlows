input {
    pipe {
        codec => "json"
        command => "tshark -i enp0s9 -a duration:60 -q -lT pdml $(/vagrant/sys/pcap_mac_filter.sh) | \
        /vagrant/flowworker.py -i enp0s9 -m all -no"
    }
    #stdin {}
}

filter{
    ruby {
        code => "event['env.hostname'] = data = File.read('/etc/hostname').strip()"
    }
    geoip {
        source => "ip.src"
        target => "ip.src.geoip" 
    }
    geoip {
        source => "ip.dst"
        target => "ip.dst.geoip" 
    }
}

output {
    elasticsearch {
        cluster => "EtherFlows"
        protocol => "transport"
        template => "/vagrant/etc/template.js"
    }
}

